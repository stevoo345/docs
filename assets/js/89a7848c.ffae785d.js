"use strict";(self.webpackChunkdocu=self.webpackChunkdocu||[]).push([[305],{6696:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"dotnet/ef-core","title":"Entity Framework","description":"Install Nuget","source":"@site/docs/dotnet/ef-core.md","sourceDirName":"dotnet","slug":"/dotnet/ef-core","permalink":"/docs/dotnet/ef-core","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Dotnet EF Cheatsheet","permalink":"/docs/dotnet/dotnet ef"},"next":{"title":"Elasticsearch + Kibana","permalink":"/docs/dotnet/elastic"}}');var r=t(4848),o=t(8453);const l={},s="Entity Framework",a={},c=[{value:"Install Nuget",id:"install-nuget",level:2},{value:"Code",id:"code",level:2},{value:"Enable Sql Logging",id:"enable-sql-logging",level:2},{value:"Serilog Output Template",id:"serilog-output-template",level:2},{value:"Explanation  Specifier",id:"explanation--specifier",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"entity-framework",children:"Entity Framework"})}),"\n",(0,r.jsx)(n.h2,{id:"install-nuget",children:"Install Nuget"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Microsoft.EntityFrameworkCore"}),"\n",(0,r.jsx)(n.li,{children:"Microsoft.EntityFrameworkCore.SqlServer"}),"\n",(0,r.jsx)(n.li,{children:"Microsoft.EntityFrameworkCore.Design (dotnet ef)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"code",children:"Code"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="DataContext.cs"',children:'public class DataContext(IConfiguration configuration) : DbContext\n{\n    public DbSet<Movie> Movies { get; set; }\n\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n    {\n        optionsBuilder.UseSqlServer(configuration.GetConnectionString("SqlServer"));\n    }\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="Program.cs"',children:"builder.Services.AddDbContext<DataContext>();\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="appsettings.json"',children:'{\n    "ConnectionStrings": {\n        "SqlServer": "..."\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"enable-sql-logging",children:"Enable Sql Logging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="DataContext.cs"',children:'public class DataContext(ILoggerFactory loggerFactory, IConfiguration configuration) : DbContext\n{\n    public DbSet<Movie> Movies { get; set; }\n\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n    {\n        optionsBuilder\n#if DEBUG\n            .UseLoggerFactory(loggerFactory)\n            .EnableSensitiveDataLogging()\n            .EnableDetailedErrors()\n#endif\n            .UseSqlServer(configuration.GetConnectionString("SqlServer"));\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"serilog-output-template",children:"Serilog Output Template"}),"\n",(0,r.jsxs)(n.h3,{id:"explanation--specifier",children:["Explanation ",":lj"," Specifier"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",":lj"," (literal JSON) specifier tells Serilog to render the message with its line breaks rather than escaping them.\nThis means that any \\r\\n characters in your EF Core SQL logs will be rendered as actual newlines in the output."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="appsettings.json"',children:'{\n    "Serilog": {\n        "WriteTo": {\n            "Name": "Console",\n            "Args": {\n                "outputTemplate": "..{Message:lj}.."\n            }\n        }\n    }\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>s});var i=t(6540);const r={},o=i.createContext(r);function l(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);